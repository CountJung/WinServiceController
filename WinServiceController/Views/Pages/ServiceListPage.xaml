<Page
  x:Class="WinServiceController.Views.Pages.ServiceListPage"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:WinServiceController.Views.Pages"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
  Title="ServiceListPage"
  d:DataContext="{d:DesignInstance local:ServiceListPage,
                                     IsDesignTimeCreatable=False}"
  d:DesignHeight="600"
  d:DesignWidth="900"
  ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
  ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
  Foreground="{DynamicResource TextFillColorPrimaryBrush}"
  mc:Ignorable="d"
>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <!-- Header -->
    <TextBlock
      Grid.Row="0"
      FontSize="24"
      FontWeight="SemiBold"
      Text="Services"
    />

    <!-- Search + Refresh -->
    <Grid Grid.Row="1" Margin="0,16,0,8">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>
      <ui:TextBox
        Grid.Column="0"
        PlaceholderText="Search services..."
        Text="{Binding ViewModel.SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
      />
      <ui:Button
        Grid.Column="1"
        Margin="8,0,0,0"
        Appearance="Transparent"
        Command="{Binding ViewModel.RefreshServicesAsyncCommand, Mode=OneWay}"
        Icon="{ui:SymbolIcon ArrowSync24}"
        ToolTip="Refresh"
      />
    </Grid>

    <!-- Service List -->
    <ui:ListView
      Grid.Row="2"
      ItemsSource="{Binding ViewModel.Services, Mode=OneWay}"
      SelectedItem="{Binding ViewModel.SelectedService, Mode=TwoWay}"
    >
      <ui:ListView.View>
        <GridView>
          <GridViewColumn Width="200" Header="Display Name" DisplayMemberBinding="{Binding DisplayName}" />
          <GridViewColumn Width="160" Header="Service Name" DisplayMemberBinding="{Binding ServiceName}" />
          <GridViewColumn Width="100" Header="Status" DisplayMemberBinding="{Binding StatusText}" />
          <GridViewColumn Width="80" Header="CPU (%)" DisplayMemberBinding="{Binding CpuUsage, StringFormat='{}{0:F1}'}" />
          <GridViewColumn Width="100" Header="Memory (MB)" DisplayMemberBinding="{Binding MemoryMB, StringFormat='{}{0:F1}'}" />
        </GridView>
      </ui:ListView.View>
    </ui:ListView>

    <!-- Control Buttons -->
    <StackPanel
      Grid.Row="3"
      Margin="0,12,0,0"
      HorizontalAlignment="Left"
      Orientation="Horizontal"
    >
      <ui:Button
        Margin="0,0,8,0"
        Appearance="Success"
        Command="{Binding ViewModel.StartServiceCommand, Mode=OneWay}"
        Content="Start"
        Icon="{ui:SymbolIcon Play24}"
      />
      <ui:Button
        Margin="0,0,8,0"
        Appearance="Danger"
        Command="{Binding ViewModel.StopServiceCommand, Mode=OneWay}"
        Content="Stop"
        Icon="{ui:SymbolIcon Stop24}"
      />
      <ui:Button
        Appearance="Caution"
        Command="{Binding ViewModel.RestartServiceCommand, Mode=OneWay}"
        Content="Restart"
        Icon="{ui:SymbolIcon ArrowSync24}"
      />
    </StackPanel>
  </Grid>
</Page>
